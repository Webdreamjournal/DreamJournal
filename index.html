<!-- 
Dream Journal v1.43.17 - A privacy-focused dream tracking application
Copyright (C) 2025 Dream Journal Contributors

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU Affero General Public License for more details.
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dream Journal</title>
    <style>
        /* === DREAM JOURNAL OPTIMIZED CSS === */
        /* HSL Theme System + Utility Classes */
        /* === OPTIMIZED HSL THEME SYSTEM === */
        
        :root {
            /* Static values that don't change between themes */
            --border-radius: 8px;
            --border-radius-lg: 12px;
            --border-radius-xl: 15px;
            --font-weight-medium: 500;
            --font-weight-semibold: 600;
            --transition: all 0.3s ease;
            
            /* === COLOR BASE SYSTEM (HSL) === */
            /* Core color families - hue & saturation never change */
            --primary-h: 238;    --primary-s: 84%;
            --success-h: 158;    --success-s: 64%;
            --error-h: 0;        --error-s: 84%;
            --warning-h: 32;     --warning-s: 95%;
            --info-h: 199;       --info-s: 89%;
            
            /* Neutral grays */
            --neutral-h: 222;    --neutral-s: 47%;
            --slate-h: 215;      --slate-s: 20%;
            --gray-h: 220;       --gray-s: 13%;
            
            /* === LIGHT THEME LIGHTNESS VALUES === */
            /* Backgrounds */
            --bg-primary-l: 100%;      --bg-secondary-l: 100%;
            --bg-elevated-l: 100%;     --bg-input-l: 100%;
            --bg-hover-l: 98%;         --bg-subtle-l: 95%;
            --bg-light-l: 98%;         --bg-disabled-l: 99%;
            --bg-selected-l: 97%;
            
            /* Text */
            --text-primary-l: 11%;     --text-secondary-l: 38%;
            --text-tertiary-l: 42%;    --text-muted-l: 64%;
            --text-inverse-l: 100%;    --text-disabled-l: 42%;
            
            /* Borders */
            --border-light-l: 95%;     --border-color-l: 88%;
            --border-dark-l: 82%;      --border-hover-l: 82%;
            
            /* Semantic colors - consistent lightness */
            --primary-l: 59%;          --primary-hover-l: 52%;
            --success-l: 30%;          --success-hover-l: 26%;
            --error-l: 51%;            --error-hover-l: 44%;
            --warning-l: 44%;          --info-l: 39%;
            --secondary-l: 46%;        --secondary-hover-l: 35%;
            
            /* Component specific */
            --shadow-opacity: 0.1;     --modal-backdrop-opacity: 0.9;
            --voice-bg-l: 97%;         --voice-border-l: 86%;       --voice-text-l: 39%;
            --tag-bg-l: 97%;           --tag-text-l: 39%;           --tag-border-l: 86%;
            --dream-sign-bg-l: 95%;    --dream-sign-text-l: 44%;    --dream-sign-border-l: 88%;
            --notification-error-l: 93%;   --notification-success-l: 89%;
            --notification-warning-l: 95%; --notification-info-l: 97%;
        }
        
        /* === UTILITY CLASS SYSTEM === */
        /* Layout & Structure */
        .card { background: var(--bg-secondary); border: 2px solid var(--border-color); }
        .card-elevated { background: var(--bg-elevated); border: 2px solid var(--border-color); }
        .card-lg { border-radius: var(--border-radius-xl); padding: 40px; }
        .card-md { border-radius: var(--border-radius-lg); padding: 20px; }
        .card-sm { border-radius: var(--border-radius); padding: 15px; }
        
        /* Flexbox utilities */
        .flex-center { display: flex; align-items: center; justify-content: center; }
        .flex-between { display: flex; align-items: center; justify-content: space-between; }
        .flex-col { display: flex; flex-direction: column; }
        .flex-wrap { flex-wrap: wrap; }
        
        /* Spacing system */
        .gap-xs { gap: 5px; } .gap-sm { gap: 8px; } .gap-md { gap: 15px; } .gap-lg { gap: 20px; }
        .p-sm { padding: 8px; } .p-md { padding: 15px; } .p-lg { padding: 20px; } .p-xl { padding: 40px; }
        .mb-sm { margin-bottom: 10px; } .mb-md { margin-bottom: 15px; } .mb-lg { margin-bottom: 20px; }
        .mt-sm { margin-top: 10px; } .mt-md { margin-top: 15px; } .mt-lg { margin-top: 20px; }
        .mx-lg { margin-left: 20px; margin-right: 20px; }
        
        /* Typography utilities */
        .text-center { text-align: center; } .text-left { text-align: left; }
        .text-sm { font-size: 0.9em; } .text-base { font-size: 1em; } .text-lg { font-size: 1.2em; } 
        .text-xl { font-size: 1.6em; } .text-2xl { font-size: 1.8em; } .text-4xl { font-size: 4em; }
        .font-normal { font-weight: normal; } .font-semibold { font-weight: var(--font-weight-semibold); }
        .text-primary { color: var(--text-primary); } .text-secondary { color: var(--text-secondary); }
        .text-warning { color: var(--warning-color); }
        .line-height-relaxed { line-height: 1.5; } .line-height-loose { line-height: 1.6; }
        
        /* Width utilities */
        .w-full { width: 100%; } .max-w-sm { max-width: 400px; }
        
        /* Message utilities */
        .message-base { padding: 15px; border-radius: var(--border-radius); margin-bottom: 20px; 
                        font-weight: var(--font-weight-semibold); text-align: center; }
        .message-success { background: var(--notification-success-bg); color: var(--success-color); }
        .message-error { background: var(--notification-error-bg); color: var(--error-color); }
        .message-warning { background: var(--notification-warning-bg); color: var(--warning-color); }
        .message-info { background: var(--notification-info-bg); color: var(--info-color); }
        
        /* Input utilities */
        .input-pin { padding: 15px; border: 2px solid var(--border-color); border-radius: var(--border-radius); 
                     font-size: 18px; text-align: center; letter-spacing: 3px; font-family: monospace; 
                     background: var(--bg-input); }
        
        /* Box shadow utilities */
        .shadow-lg { box-shadow: var(--shadow-lg); }
        
        /* === VOICE NOTES UTILITIES === */
        /* Voice controls layout */
        .voice-note-container { display: flex; align-items: center; gap: 15px; flex-wrap: wrap; 
                                background: var(--bg-secondary); border: 2px solid var(--border-color); 
                                border-radius: var(--border-radius); padding: 15px; margin-bottom: 15px; 
                                transition: var(--transition); }
        .voice-note-container:hover { border-color: var(--border-hover); box-shadow: var(--shadow-md); }
        .voice-note-container.delete-pending { background: var(--notification-warning-bg); 
                                               border-color: var(--warning-color); }
        
        /* Voice note content layout */
        .voice-note-info { flex: 1; min-width: 200px; }
        .voice-note-title { font-weight: var(--font-weight-semibold); color: var(--text-primary); 
                            margin-bottom: 4px; }
        .voice-note-meta { color: var(--text-secondary); font-size: 14px; }
        .voice-note-controls { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; 
                               min-width: 300px; }
        
        /* Voice button base styling */
        .voice-btn-base { padding: 6px 12px; border: none; border-radius: 6px; font-size: 12px; 
                          font-weight: var(--font-weight-semibold); cursor: pointer; transition: var(--transition); 
                          display: flex; align-items: center; gap: 4px; }
        
        /* === STATS TAB SYSTEM === */
        #statsContainer {
            min-height: 1200px; /* Prevents layout jump on first load */
        }

        .stats-tabs {
            display: flex;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0;
            margin: 0;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .stats-tab {
            background: transparent;
            border: none;
            padding: 15px 20px;
            font-weight: var(--font-weight-semibold);
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
            white-space: nowrap;
            flex-shrink: 0;
            font-size: 14px;
        }
        
        .stats-tab:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }
        
        .stats-tab.active {
            background: var(--primary-color);
            color: var(--text-inverse);
        }
        
        .stats-tab-content {
            background: var(--bg-primary);
            border: 2px solid var(--border-color);
            border-top: none;
            border-radius: 0 0 var(--border-radius-lg) var(--border-radius-lg);
            padding: 20px;
            min-height: 800px; /* Adjust as needed to prevent jump */
        }
        
        .stats-tab-panel {
            width: 100%;
        }

        .word-cloud {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 15px;
            padding: 20px;
        }
        .word-cloud-item {
            display: inline-block;
            font-weight: 600;
            transition: transform 0.2s ease;
            cursor: default;
        }
        .word-cloud-item:hover {
            transform: scale(1.1);
        }
        
        /* Voice button variants */
        .voice-btn-play { background: var(--info-color); color: var(--text-inverse); }
        .voice-btn-play:hover { background: #0284c7; }
        .voice-btn-pause { background: var(--warning-color); color: var(--text-inverse); }
        .voice-btn-pause:hover { background: #d97706; }
        .voice-btn-transcribe { background: #7c3aed; color: var(--text-inverse); }
        .voice-btn-transcribe:hover { background: #6d28d9; }
        .voice-btn-transcribe:disabled { background: var(--text-muted); cursor: not-allowed; }
        .voice-btn-download { background: var(--success-color); color: var(--text-inverse); }
        .voice-btn-download:hover { background: var(--success-hover); }
        .voice-btn-delete { background: var(--error-color); color: var(--text-inverse); }
        .voice-btn-delete:hover { background: var(--error-hover); }
        
        /* Voice progress container */
        .voice-progress-container { flex: 1; min-width: 200px; display: flex; align-items: center; 
                                    gap: 8px; margin: 0 15px; }
        .voice-time-display { font-family: monospace; font-size: 12px; color: var(--text-secondary); 
                              min-width: 80px; text-align: center; }
        
        /* Voice warning messages */
        .voice-full-warning { background: var(--notification-error-bg); color: var(--error-color); 
                              padding: 12px; border-radius: var(--border-radius); 
                              border: 2px solid var(--error-color); margin-bottom: 15px; 
                              font-weight: var(--font-weight-semibold); text-align: center; }
        .no-voice-notes { text-align: center; color: var(--text-secondary); font-style: italic; 
                          padding: 30px; background: var(--bg-light); border: var(--border-dashed); 
                          border-radius: var(--border-radius); }
        
        /* === DREAM ENTRY UTILITIES === */
        /* Dream entry emotion display */
        .entry-emotions { margin-top: 8px; color: var(--text-secondary); font-size: 0.9em; }
        .entry-emotions span { font-weight: var(--font-weight-semibold); }
        
        /* === FINAL OPTIMIZATION UTILITIES === */
        /* Pagination and info display */
        .pagination-info { text-align: center; padding: 20px; color: var(--text-secondary); }
        
        /* Small text utilities */
        .text-xs { font-size: 0.6em; } .text-xxs { font-size: 12px; }
        .small-helper { color: var(--text-secondary); font-size: 0.9em; margin-top: 5px; display: block; }
        .small-helper-warning { color: var(--warning-color); font-size: 0.9em; margin-top: 5px; display: block; }
        
        /* Form utilities */
        .form-checkbox { width: 16px; height: 16px; accent-color: var(--primary-color); }
        .form-label-inline { font-size: 14px; font-weight: var(--font-weight-semibold); cursor: pointer; }
        
        /* Footer and structural elements */
        .app-footer { background: var(--bg-light); border-top: 1px solid var(--border-color); 
                      padding: 20px; margin-top: 40px; text-align: center; 
                      color: var(--text-secondary); font-size: 14px; }
        .app-footer p { margin: 0; font-size: 12px; opacity: 0.8; }
        
        /* Feedback and autocomplete */
        .feedback-container { border-radius: var(--border-radius); display: none; }
        .autocomplete-item { padding: 8px 12px; cursor: pointer; border-bottom: 1px solid var(--border-light); font-size: 14px; }
        
        /* === TAB CONTENT UTILITIES === */
        /* Progress bars */
        .progress-bar { background: var(--border-color); height: 8px; border-radius: 4px; overflow: hidden; }
        .progress-fill { background: var(--success-color); height: 100%; transition: width 0.3s; }
        .progress-success { background: var(--success-color); }
        .progress-primary { background: var(--primary-color); }
        
        /* Status indicators */
        .status-success { color: var(--success-color); font-weight: var(--font-weight-semibold); }
        .status-warning { color: var(--warning-color); font-weight: var(--font-weight-semibold); }
        .status-primary { color: var(--primary-color); font-weight: var(--font-weight-semibold); }
        .status-info { color: var(--info-color); font-weight: var(--font-weight-semibold); }
        
        /* Icon containers */
        .icon-lg { font-size: 2em; margin-bottom: 10px; }
        .icon-xl { font-size: 2.5em; margin-bottom: 10px; }
        
        /* Feature sections */
        .feature-item { background: var(--bg-light); padding: 15px; border-radius: var(--border-radius); 
                        display: flex; align-items: center; gap: 15px; }
        .feature-list { display: grid; gap: 15px; }
        
        /* Border accents */
        .border-l-primary { border-left: 4px solid var(--primary-color); }
        .border-l-success { border-left: 4px solid var(--success-color); }
        .border-l-warning { border-left: 4px solid var(--warning-color); }
        .border-l-info { border-left: 4px solid var(--info-color); }
        
        /* Layout grids */
        .grid-auto { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .grid-1 { display: grid; grid-template-columns: 1fr; gap: 15px; }
        
        /* Progress display */
        .progress-display { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        
        /* Content sections */
        .content-highlight { background: linear-gradient(135deg, var(--bg-elevated), var(--bg-secondary)); }
        
        /* Day counters */
        .day-counter { color: var(--primary-color); font-weight: var(--font-weight-semibold); }
        
        /* === DARK THEME - ONLY LIGHTNESS OVERRIDES === */
        [data-theme='dark'] {
            /* Backgrounds - dark */
            --bg-primary-l: 5%;        --bg-secondary-l: 11%;
            --bg-elevated-l: 20%;      --bg-input-l: 11%;
            --bg-hover-l: 20%;         --bg-subtle-l: 28%;
            --bg-light-l: 11%;         --bg-disabled-l: 5%;
            --bg-selected-l: 20%;
            
            /* Text - light */
            --text-primary-l: 98%;     --text-secondary-l: 83%;
            --text-tertiary-l: 68%;    --text-muted-l: 52%;
            --text-inverse-l: 5%;      --text-disabled-l: 52%;
            
            /* Borders - lighter */
            --border-light-l: 20%;     --border-color-l: 28%;
            --border-dark-l: 52%;      --border-hover-l: 59%;
            
            /* Semantic colors - adjusted for dark backgrounds */
            --primary-l: 67%;          --primary-hover-l: 53%;
            --success-l: 70%;          --success-hover-l: 30%;
            --error-l: 72%;            --error-hover-l: 51%;
            --warning-l: 71%;          --info-l: 67%;
            --secondary-l: 68%;        --secondary-hover-l: 83%;
            
            /* Component adjustments */
            --shadow-opacity: 0.3;     --modal-backdrop-opacity: 0.95;
            --voice-bg-l: 20%;         --voice-border-l: 67%;       --voice-text-l: 74%;
            --tag-bg-l: 20%;           --tag-text-l: 74%;           --tag-border-l: 67%;
            --dream-sign-bg-l: 15%;    --dream-sign-text-l: 81%;    --dream-sign-border-l: 35%;
            --notification-error-l: 20%;   --notification-success-l: 15%;
            --notification-warning-l: 15%; --notification-info-l: 20%;
            
            /* Special dark theme hue adjustments */
            --warning-h: 45;  /* Warmer yellow in dark mode */
        }
        
        /* === GENERATED COLOR SYSTEM === */
        :root,
        [data-theme='light'],
        [data-theme='dark'] {
            /* Core Theme Colors */
            --primary-color: hsl(var(--primary-h), var(--primary-s), var(--primary-l));
            --primary-hover: hsl(var(--primary-h), var(--primary-s), var(--primary-hover-l));
            --secondary-color: hsl(var(--slate-h), var(--slate-s), var(--secondary-l));
            --secondary-hover: hsl(var(--slate-h), var(--slate-s), var(--secondary-hover-l));
            --success-color: hsl(var(--success-h), var(--success-s), var(--success-l));
            --success-hover: hsl(var(--success-h), var(--success-s), var(--success-hover-l));
            --error-color: hsl(var(--error-h), var(--error-s), var(--error-l));
            --error-hover: hsl(var(--error-h), var(--error-s), var(--error-hover-l));
            --warning-color: hsl(var(--warning-h), var(--warning-s), var(--warning-l));
            --warning-hover: hsl(var(--warning-h), var(--warning-s), var(--warning-l));
            --info-color: hsl(var(--info-h), var(--info-s), var(--info-l));
            --info-hover: hsl(var(--info-h), var(--info-s), var(--info-l));
            
            /* Background Hierarchy */
            --bg-primary: hsl(var(--neutral-h), var(--neutral-s), var(--bg-primary-l));
            --bg-secondary: hsl(var(--neutral-h), var(--neutral-s), var(--bg-secondary-l));
            --bg-elevated: hsl(var(--gray-h), var(--gray-s), var(--bg-elevated-l));
            --bg-input: hsl(var(--neutral-h), var(--neutral-s), var(--bg-input-l));
            --bg-hover: hsl(var(--gray-h), var(--gray-s), var(--bg-hover-l));
            --bg-subtle: hsl(var(--slate-h), var(--slate-s), var(--bg-subtle-l));
            --bg-light: hsl(var(--gray-h), var(--gray-s), var(--bg-light-l));
            --bg-disabled: hsl(var(--gray-h), var(--gray-s), var(--bg-disabled-l));
            --bg-selected: hsl(var(--info-h), var(--info-s), var(--bg-selected-l));
            
            /* Text Hierarchy */
            --text-primary: hsl(var(--neutral-h), var(--neutral-s), var(--text-primary-l));
            --text-secondary: hsl(var(--slate-h), var(--slate-s), var(--text-secondary-l));
            --text-tertiary: hsl(var(--gray-h), var(--gray-s), var(--text-tertiary-l));
            --text-muted: hsl(var(--gray-h), var(--gray-s), var(--text-muted-l));
            --text-inverse: hsl(var(--neutral-h), var(--neutral-s), var(--text-inverse-l));
            --text-disabled: hsl(var(--gray-h), var(--gray-s), var(--text-disabled-l));
            
            /* Border System */
            --border-light: hsl(var(--slate-h), var(--slate-s), var(--border-light-l));
            --border-color: hsl(var(--slate-h), var(--slate-s), var(--border-color-l));
            --border-dark: hsl(var(--slate-h), var(--slate-s), var(--border-dark-l));
            --border-hover: hsl(var(--primary-h), var(--primary-s), var(--border-hover-l));
            --border-focus: var(--primary-color);
            
            /* Shadow System */
            --shadow-color: rgba(0, 0, 0, var(--shadow-opacity));
            --shadow-color-light: rgba(0, 0, 0, calc(var(--shadow-opacity) * 0.5));
            --shadow-color-dark: rgba(0, 0, 0, calc(var(--shadow-opacity) * 1.5));
            
            /* Component Specific */
            --modal-backdrop: rgba(0, 0, 0, var(--modal-backdrop-opacity));
            --gradient-primary: linear-gradient(135deg, var(--primary-color), hsl(var(--primary-h), var(--primary-s), calc(var(--primary-l) - 10%)));
            --border-dashed: 2px dashed var(--border-dark);
            
            /* Voice Component Colors */
            --voice-bg-primary: hsl(var(--info-h), var(--info-s), var(--voice-bg-l));
            --voice-border: hsl(var(--info-h), var(--info-s), var(--voice-border-l));
            --voice-text: hsl(var(--info-h), var(--info-s), var(--voice-text-l));
            
            /* Tag & Component Colors */
            --tag-bg: hsl(var(--info-h), var(--info-s), var(--tag-bg-l));
            --tag-text: hsl(var(--info-h), var(--info-s), var(--tag-text-l));
            --tag-border: hsl(var(--info-h), var(--info-s), var(--tag-border-l));
            --dream-sign-bg: hsl(var(--warning-h), var(--warning-s), var(--dream-sign-bg-l));
            --dream-sign-text: hsl(var(--warning-h), var(--warning-s), var(--dream-sign-text-l));
            --dream-sign-border: hsl(var(--warning-h), var(--warning-s), var(--dream-sign-border-l));
            
            /* Interactive States */
            --input-focus-ring: hsla(var(--primary-h), var(--primary-s), var(--primary-l), 0.2);
            --selection-bg: var(--primary-color);
            --selection-text: var(--text-inverse);
            
            /* Notification Backgrounds */
            --notification-error-bg: hsl(var(--error-h), var(--error-s), var(--notification-error-l));
            --notification-success-bg: hsl(var(--success-h), var(--success-s), var(--notification-success-l));
            --notification-warning-bg: hsl(var(--warning-h), var(--warning-s), var(--notification-warning-l));
            --notification-info-bg: hsl(var(--info-h), var(--info-s), var(--notification-info-l));
        }
        
        /* Shadow definitions using the optimized theme system */
        :root,
        [data-theme='light'],
        [data-theme='dark'] {
            --shadow-sm: 0 1px 2px var(--shadow-color);
            --shadow-md: 0 4px 6px var(--shadow-color);
            --shadow-lg: 0 10px 25px var(--shadow-color);
            --shadow-xl: 0 20px 60px var(--shadow-color-dark);
        }
        
        /* Extra Small Mobile Screens */
        @media (max-width: 480px) {
            body {
                padding: 2px;
            }
            
            .container {
                border-radius: 0;
                margin: 0;
            }
            
            .header {
                padding: 15px 10px;
            }
            
            .main-content,
            .tab-panel:not(#journalTab) {
                padding: 10px;
            }
            
            .controls {
                padding: 10px;
            }
            
            .entry-form,
            .settings-section {
                padding: 15px 10px;
            }
            
            .stats-card {
                padding: 15px 10px;
            }
            
            .voice-tab-content {
                padding: 10px;
            }
            
            /* Extra small screens - compress tabs further */
            .app-tab {
                min-width: 50px;
                padding: 12px 6px;
                font-size: 11px;
            }
            
            /* Make date filters stack on very small screens */
            .date-filter-group {
                grid-template-columns: auto 1fr !important;
                grid-template-rows: auto auto !important;
                gap: 6px !important;
            }
            
            .date-filter-group label:nth-child(3) {
                grid-column: 1;
                grid-row: 2;
            }
            
            .date-filter-group input:nth-child(4) {
                grid-column: 2;
                grid-row: 2;
            }
        }
        


        
        body {
            margin: 0;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-subtle);
            color: var(--text-primary);
            transition: background-color 0.3s ease, color 0.3s ease;
            min-height: 100vh;
        }
        
        /* BASE STYLES & LAYOUT COMPONENTS */
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        /* Smooth theme transitions for all elements */
        *,
        *::before,
        *::after {
            transition: background-color 0.3s ease, 
                       color 0.3s ease, 
                       border-color 0.3s ease, 
                       box-shadow 0.3s ease;
        }
        
        /* Preserve faster transitions for interactive elements */
        button,
        .btn,
        input,
        select,
        textarea {
            transition: background-color 0.3s ease, 
                       color 0.3s ease, 
                       border-color 0.3s ease, 
                       box-shadow 0.3s ease,
                       transform 0.2s ease;
        }

        .autocomplete-item {
            padding: 8px 12px;
            cursor: pointer;
            border-bottom: 1px solid var(--border-light);
            font-size: 14px;
            transition: background-color 0.2s;
        }
        .autocomplete-item:hover {
            background-color: var(--bg-hover);
        }
        .autocomplete-item:last-child {
            border-bottom: none;
        }
        
        /* Loading States - Consolidated */
        .loading-state, .search-loading, .loading-dreams {
            padding: 20px;
            text-align: center;
            color: var(--text-secondary);
            font-style: italic;
            background: var(--bg-light);
            border-radius: var(--border-radius);
            margin: 10px 0;
        }
        
        .loading-state.large, .loading-dreams {
            padding: 40px;
            font-style: normal;
        }
        .loading-state.large div:first-child, .loading-dreams div:first-child {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--bg-primary);
            border-radius: var(--border-radius-xl);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            width: 100%;
            box-sizing: border-box;
        }
        
        .search-loading {
            padding: 20px;
            text-align: center;
            color: #64748b;
            font-style: italic;
            background: #f8fafc;
            border-radius: 8px;
            margin: 10px 0;
        }
        
        .loading-dreams {
            padding: 40px;
            text-align: center;
            color: #64748b;
        }
        .loading-dreams div:first-child {
            font-size: 2em;
            margin-bottom: 10px;
        }
        .header {
            background: var(--gradient-primary);
            color: var(--text-inverse);
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }
        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }
        .controls {
            padding: 20px;
            background: var(--bg-light);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }
        .control-row-break {
            flex-basis: 100%;
            height: 0;
        }
        .search-filter-group {
            display: flex;
            gap: 10px;
            flex: 1;
            min-width: 500px;
        }
        .export-import-controls {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 15px;
            flex-wrap: wrap;
        }
        .ai-export-control {
            margin-left: auto;
        }
        
        /* Hide file input completely */
        .file-input,
        input[type="file"].file-input,
        #importFile,
        #importAllDataFile {
            display: none !important;
            visibility: hidden !important;
            position: absolute !important;
            left: -9999px !important;
        }
        .search-box {
            flex: 2;
            min-width: 150px;
            padding: 12px 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 16px;
            background: var(--bg-input);
            color: var(--text-primary);
            transition: border-color 0.3s;
        }
        .filter-select {
            flex: 1;
            min-width: 90px;
            padding: 12px 15px;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 16px;
            background: var(--bg-input);
            color: var(--text-primary);
            cursor: pointer;
            transition: border-color 0.3s;
        }
        .filter-select:focus,
        .search-box:focus {
            outline: none;
            border-color: var(--border-focus);
        }
        /* Button System */
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: var(--border-radius);
            font-size: 14px;
            font-weight: var(--font-weight-semibold);
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }
        
        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 6px;
        }
        
        /* Button Colors - Combined selectors */
        .btn-primary, .btn-success {
            color: white;
        }
        
        .btn-primary {
            background: var(--primary-color);
        }
        .btn-primary:hover {
            background: var(--primary-hover);
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: var(--secondary-color);
            color: var(--text-primary);
        }
        .btn-secondary:hover {
            background: var(--secondary-hover);
        }
        
        /* Dark theme specific button hover fixes */
        [data-theme='dark'] .btn-secondary {
            color: var(--text-inverse);
        }
        [data-theme='dark'] .btn-secondary:hover {
            background: #64748b;
        }
        
        .btn-success {
            background: var(--success-color);
            color: var(--text-inverse);
        }
        .btn-success:hover {
            background: var(--success-hover);
            color: var(--text-inverse);
        }
        
        .btn-edit {
            background: var(--info-color);
            color: var(--text-inverse);
        }
        .btn-edit:hover {
            background: #0284c7;
        }
        
        .btn-delete {
            background: var(--error-color);
            color: var(--text-inverse);
        }
        .btn-delete:hover {
            background: var(--error-hover);
        }
        
        .btn-confirm-delete {
            background: var(--error-hover);
            color: var(--text-inverse);
            animation: pulse 0.5s ease-in-out;
        }
        .btn-confirm-delete:hover {
            background: #b91c1c;
        }
        
        .btn-lock {
            background: var(--text-tertiary);
            color: var(--text-inverse);
            padding: 8px 12px;
            font-size: 12px;
        }
        .btn-lock:hover {
            background: var(--text-secondary);
        }
        
        /* Loading States - Consolidated */
        .loading-state {
            padding: 20px;
            text-align: center;
            color: var(--text-secondary);
            font-style: italic;
            background: var(--bg-light);
            border-radius: var(--border-radius);
            margin: 10px 0;
        }
        
        .loading-state.large {
            padding: 40px;
            font-style: normal;
        }
        .loading-state.large div:first-child {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        /* Notification Messages - Consolidated */
        .notification-message {
            font-size: 14px;
            margin-top: 10px;
            padding: 10px;
            border-radius: var(--border-radius);
            display: none;
            font-weight: var(--font-weight-semibold);
        }
        .notification-message.error {
            color: var(--error-color);
            background: var(--notification-error-bg);
        }
        .notification-message.success {
            color: var(--success-color);
            background: var(--notification-success-bg);
        }
        .notification-message.info {
            color: var(--info-color);
            background: var(--notification-info-bg);
        }
        .notification-message.warning {
            color: var(--warning-color);
            background: var(--notification-warning-bg);
        }
        
        /* FORM COMPONENTS & INTERACTIVE ELEMENTS */
        
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: var(--font-weight-semibold);
            color: var(--text-primary);
        }
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 16px;
            transition: border-color 0.3s;
            font-family: inherit;
            background: var(--bg-input);
            color: var(--text-primary);
        }
        .form-control:focus {
            outline: none;
            border-color: var(--border-focus);
        }
        
        .form-control::placeholder,
        .search-box::placeholder {
            color: var(--text-tertiary);
            opacity: 1;
        }
        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }
        .lucid-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 20px;
        }
        .lucid-checkbox input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #4f46e5;
        }
        .lucid-checkbox label {
            margin: 0;
            font-weight: var(--font-weight-semibold);
            color: var(--text-primary);
            cursor: pointer;
        }
        .dreams-section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            margin-left: 20px;
            margin-right: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        .dreams-section-header h3 {
            margin: 0;
            color: var(--text-primary);
            font-size: 1.3em;
        }
        .dreams-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .autocomplete-management-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            max-height: 250px;
            overflow-y: auto;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 10px;
            margin-top: 15px;
            background: var(--bg-light);
        }

        .autocomplete-list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: var(--bg-secondary);
            border-radius: 6px;
            font-size: 14px;
            border: 1px solid var(--border-light);
        }

        .autocomplete-list-item.default .item-value {
            color: var(--text-secondary);
            font-style: italic;
        }

        .autocomplete-list-item .item-type {
            font-size: 11px;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 10px;
            background: var(--bg-input);
            color: var(--text-tertiary);
            text-transform: uppercase;
            margin-left: 10px;
        }
        .entries-section {
            margin-left: 20px;
            margin-right: 20px;
            margin-top: 24px;
            margin-bottom: 24px;
        }
        .entries-section h3 {
            margin-bottom: 20px;
            color: var(--text-primary);
            font-size: 1.3em;
        }
        .entry {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-lg);
            padding: 20px;
            margin-bottom: 20px;
            transition: var(--transition);
        }
        .entry:hover {
            border-color: var(--border-hover);
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.1);
        }
        /* Light Theme Lucid Dreams */
        :root .entry.lucid,
        [data-theme='light'] .entry.lucid {
            border-color: var(--success-color);
            background: linear-gradient(135deg, #f0fdf4, var(--bg-secondary));
            position: relative;
        }
        
        /* Dark Theme Lucid Dreams - More prominent override */
        [data-theme='dark'] .entry.lucid {
            border-color: var(--success-color) !important;
            background: linear-gradient(135deg, #0f2e1a, var(--bg-secondary)) !important;
            position: relative;
        }
        
        .entry.lucid::before {
            content: "✨ LUCID";
            position: absolute;
            top: -10px;
            right: 20px;
            background: var(--success-color);
            color: var(--text-inverse);
            padding: 4px 12px;
            border-radius: var(--border-radius-lg);
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 0.5px;
        }
        
        /* Light Theme Lucid Hover */
        :root .entry.lucid:hover,
        [data-theme='light'] .entry.lucid:hover {
            border-color: var(--success-hover);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2);
        }
        
        /* Dark Theme Lucid Hover - More prominent */
        [data-theme='dark'] .entry.lucid:hover {
            border-color: var(--success-hover) !important;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3) !important;
            background: linear-gradient(135deg, #1a3d28, var(--bg-secondary)) !important;
        }
        .entry-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        .entry-title {
            font-size: 1.2em;
            font-weight: var(--font-weight-semibold);
            color: var(--text-primary);
            flex: 1;
        }
        .entry-meta {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        .entry-date {
            color: var(--text-secondary);
            font-size: 0.9em;
            font-weight: var(--font-weight-medium);
        }
        .entry-actions {
            display: flex;
            gap: 5px;
        }
        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 6px;
        }
        .btn-edit {
            background: #0ea5e9;
            color: white;
        }
        .btn-edit:hover {
            background: #0284c7;
        }
        .btn-delete {
            background: #ef4444;
            color: white;
        }
        .btn-delete:hover {
            background: #dc2626;
        }
        .btn-confirm-delete {
            background: #dc2626;
            color: white;
            animation: pulse 0.5s ease-in-out;
        }
        .btn-confirm-delete:hover {
            background: #b91c1c;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .delete-pending {
            background: var(--notification-warning-bg);
            border-color: var(--warning-color) !important;
        }
        /* STYLES FOR .edit-mode HAVE BEEN REMOVED AND CONSOLIDATED INTO .inline-edit-form */
        /* This rule is now handled by .inline-edit-form .edit-actions */
        .entry-content {
            color: var(--text-primary);
            line-height: 1.7;
            white-space: pre-wrap;
        }

        .entry-form {
            background: var(--bg-light);
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
            border: 2px solid var(--border-color);
        }

        .entry-form h3 {
            margin-bottom: 15px;
            color: var(--text-primary);
            font-size: 1.3em;
        }

        .no-entries {
            text-align: center;
            color: var(--text-secondary);
            font-style: italic;
            padding: 40px;
            background: var(--bg-light);
            border-radius: var(--border-radius-lg);
            border: var(--border-dashed);
        }
        /* Pagination System */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            padding: 30px 20px;
            margin-top: 20px;
            border-top: 1px solid var(--border-color);
            background: var(--bg-light);
        }
        
        .pagination-info {
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: var(--font-weight-medium);
        }
        
        .pagination-btn, .page-btn {
            border: 2px solid var(--border-color);
            background: var(--bg-secondary);
            border-radius: 6px;
            font-size: 14px;
            font-weight: var(--font-weight-semibold);
            cursor: pointer;
            transition: var(--transition);
            color: var(--text-primary);
        }
        
        .pagination-btn {
            padding: 8px 16px;
        }
        
        .page-btn {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .pagination-btn:hover:not(:disabled), .page-btn:hover {
            border-color: var(--border-focus);
            color: var(--primary-color);
        }
        
        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .pagination-ellipsis {
            display: flex;
            align-items: center;
            padding: 0 8px;
            color: var(--text-secondary);
            font-weight: var(--font-weight-semibold);
        }
        
        .page-btn.active {
            background: var(--primary-color);
            border-color: var(--primary-color);
            color: var(--text-inverse);
        }
        
        .page-numbers {
            display: flex;
            gap: 5px;
        }
        
        .page-ellipsis {
            color: var(--text-secondary);
            font-weight: var(--font-weight-semibold);
            padding: 0 5px;
        }
        
        /* SPECIALIZED COMPONENTS (VOICE, SECURITY, MODALS) */
        
        /* Voice Recording & Tabs */
        .voice-tabs-container {
            background: var(--voice-bg-primary);
            border: 2px solid var(--voice-border);
            border-radius: var(--border-radius-lg);
            margin-bottom: 20px;
            margin-left: 20px;
            margin-right: 20px;
            overflow: hidden;
        }
        
        .voice-tabs {
            display: flex;
            border-bottom: 2px solid var(--voice-border);
            background: var(--bg-secondary);
        }
        
        .voice-tab {
            flex: 1;
            padding: 15px 20px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-weight: var(--font-weight-semibold);
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
        }
        
        .voice-tab:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }
        
        .voice-tab.active {
            background: var(--voice-bg-primary);
            color: var(--voice-text);
            border-bottom-color: var(--voice-text);
        }
        
        .voice-tab-content {
            padding: 20px;
        }
        
        .voice-tab-panel {
            display: block;
        }
        
        .voice-tab-panel:not(.active) {
            display: none;
        }
        
        .voice-recording-section {
            background: var(--voice-bg-primary);
            border: 2px solid var(--voice-border);
            border-radius: var(--border-radius-lg);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .voice-recording-section h3 {
            color: var(--voice-text);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .voice-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .record-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: var(--font-weight-semibold);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 140px;
            justify-content: center;
        }
        
        .record-btn.ready {
            background: var(--success-color);
            color: white;
        }
        .record-btn.ready:hover {
            background: var(--success-hover);
            transform: translateY(-2px);
        }
        
        .record-btn.recording {
            background: var(--error-color);
            color: white;
            animation: pulse-record 1.5s ease-in-out infinite;
        }
        
        .record-btn.disabled {
            background: #9ca3af;
            color: #6b7280;
            cursor: not-allowed;
        }
        
        .recording-timer {
            font-family: monospace;
            font-size: 18px;
            font-weight: var(--font-weight-semibold);
            color: var(--error-color);
            background: var(--notification-error-bg);
            padding: 8px 16px;
            border-radius: var(--border-radius);
            border: 2px solid var(--error-color);
        }
        
        .voice-status {
            font-size: 14px;
            padding: 8px 12px;
            border-radius: 6px;
            font-weight: var(--font-weight-semibold);
        }
        .voice-status.info {
            background: #dbeafe;
            color: #1d4ed8;
        }
        .voice-status.warning {
            background: #fef3c7;
            color: var(--warning-color);
        }
        .voice-status.error {
            background: #fee2e2;
            color: var(--error-color);
        }
        
        /* Voice Notes */
        .voice-notes-section {
            margin-top: 30px;
            padding: 25px;
            background: var(--bg-light);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-lg);
        }
        
        .voice-notes-section h3 {
            color: var(--text-primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .voice-note {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
            transition: var(--transition);
        }
        
        .voice-note:hover {
            border-color: var(--border-hover);
            box-shadow: 0 2px 8px rgba(79, 70, 229, 0.1);
        }
        
        .voice-note.delete-pending {
            background: #fef3c7;
            border-color: #f59e0b !important;
        }
        
        .voice-note-info {
            flex: 1;
            min-width: 200px;
        }
        
        .voice-note-title {
            font-weight: var(--font-weight-semibold);
            color: var(--text-primary);
            margin-bottom: 4px;
        }
        
        .voice-note-meta {
            color: var(--text-secondary);
            font-size: 14px;
        }
        
        .voice-note-controls {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
            min-width: 300px;
        }
        
        .voice-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            font-weight: var(--font-weight-semibold);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .voice-btn.play {
            background: #0ea5e9;
            color: white;
        }
        .voice-btn.play:hover {
            background: #0284c7;
        }
        
        .voice-btn.pause {
            background: #f59e0b;
            color: white;
        }
        .voice-btn.pause:hover {
            background: var(--warning-color);
        }
        
        .voice-btn.transcribe {
            background: #7c3aed;
            color: white;
        }
        .voice-btn.transcribe:hover {
            background: #6d28d9;
        }
        .voice-btn.transcribe:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }
        
        .voice-btn.download {
            background: var(--success-color);
            color: white;
        }
        .voice-btn.download:hover {
            background: var(--success-hover);
        }
        
        .voice-btn.delete {
            background: var(--error-color);
            color: white;
        }
        .voice-btn.delete:hover {
            background: var(--error-hover);
        }
        
        .voice-progress-container {
            flex: 1;
            min-width: 200px;
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 0 15px;
        }
        
        .voice-progress-bar {
            flex: 1;
            height: 6px;
            background: var(--border-color);
            border-radius: 3px;
            position: relative;
            cursor: pointer;
            transition: height 0.2s;
        }
        .voice-progress-bar:hover {
            height: 8px;
        }
        
        .voice-progress-fill {
            height: 100%;
            background: var(--primary-color);
            border-radius: 3px;
            width: 0%;
            transition: width 0.1s linear;
        }
        
        .voice-time-display {
            font-family: monospace;
            font-size: 12px;
            color: var(--text-secondary);
            min-width: 80px;
            text-align: center;
        }
        
        .voice-full-warning {
            background: #fee2e2;
            color: var(--error-color);
            padding: 12px;
            border-radius: var(--border-radius);
            border: 2px solid #fecaca;
            margin-bottom: 15px;
            font-weight: var(--font-weight-semibold);
            text-align: center;
        }
        
        .no-voice-notes {
            text-align: center;
            color: var(--text-secondary);
            font-style: italic;
            padding: 30px;
            background: var(--bg-light);
            border: var(--border-dashed);
            border-radius: var(--border-radius);
        }
        .pin-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--modal-backdrop);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .pin-container {
            background: var(--bg-elevated);
            padding: 40px;
            border-radius: var(--border-radius-xl);
            box-shadow: var(--shadow-xl);
            text-align: center;
            max-width: 400px;
            width: 90%;
        }
        .pin-container h2 {
            color: var(--text-primary);
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        .pin-input {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 18px;
            text-align: center;
            letter-spacing: 3px;
            margin-bottom: 20px;
            font-family: monospace;
            background: var(--bg-input);
        }
        .pin-input:focus {
            outline: none;
            border-color: var(--border-focus);
        }
        .pin-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        .pin-setup-link {
            color: var(--primary-color);
            text-decoration: underline;
            cursor: pointer;
            font-size: 14px;
            margin-top: 15px;
            display: block;
        }
        .notification-message {
            font-size: 14px;
            margin-top: 10px;
            padding: 10px;
            border-radius: var(--border-radius);
            display: none;
            font-weight: var(--font-weight-semibold);
        }
        .notification-message.error {
            color: var(--error-color);
            background: var(--notification-error-bg);
        }
        .notification-message.success {
            color: var(--success-color);
            background: var(--notification-success-bg);
        }
        .notification-message.info {
            color: var(--info-color);
            background: var(--notification-info-bg);
        }
        .notification-message.warning {
            color: var(--warning-color);
            background: var(--notification-warning-bg);
        }
        
        /* Main App Tabs System */
        .app-tabs {
            display: flex;
            background: var(--bg-secondary);
            border-bottom: 2px solid var(--border-color);
            padding: 0;
            margin: 0;
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        .app-tabs::-webkit-scrollbar {
            display: none;
        }
        
        .app-tab {
            flex: 1;
            min-width: 80px;
            padding: 16px 12px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-weight: var(--font-weight-semibold);
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
            white-space: nowrap;
        }
        
        .app-tab:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }
        
        .app-tab.active {
            background: var(--bg-primary);
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }
        
        .tab-content-container {
            background: var(--bg-primary);
            min-height: 400px;
            overflow-x: hidden;
        }
        
        .tab-panel {
            display: none;
            width: 100%;
            min-height: 200px;
            background: var(--bg-primary);
            border: 2px solid transparent;
            overflow-x: hidden;
            box-sizing: border-box;
        }
        
        .tab-panel.active {
            display: block;
            border-color: var(--primary-color);
        }
        
        .tab-panel:not(#journalTab) {
            padding: 20px;
        }
        
        /* Stats Tab Styling - Theme-aware */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 0;
            width: 100%;
            box-sizing: border-box;
        }
        
        .stats-card {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-lg);
            padding: 20px;
            text-align: center;
            transition: var(--transition);
            margin-bottom: 15px;
            width: 100%;
            box-sizing: border-box;
        }
        
        .stats-card:hover {
            border-color: var(--border-hover);
            box-shadow: var(--shadow-md);
        }
        
        .hover-card {
            cursor: pointer;
            transition: var(--transition);
        }
        
        .hover-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .goal-card {
            border-left: 4px solid var(--primary-color);
        }
        
        .goal-card.completed {
            border-left-color: var(--success-color);
            opacity: 0.8;
        }
        
        .goal-progress-section {
            background: var(--bg-light);
            padding: 15px;
            border-radius: var(--border-radius);
            margin: 15px 0;
        }
        
        .goal-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        
        .custom-goal-controls {
            border-top: 1px solid var(--border-color);
            padding-top: 15px;
        }
        
        .custom-goal-controls .btn {
            min-width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }
        
        /* Dark theme fixes for Goals/Advice content boxes */
        [data-theme='dark'] .stats-card {
            background: var(--bg-secondary) !important;
            border-color: var(--border-color) !important;
        }
        
        /* Fix light backgrounds in dynamically created content */
        [data-theme='dark'] div[style*="background: linear-gradient(135deg, #f0f9ff"] {
            background: linear-gradient(135deg, var(--bg-elevated), var(--bg-secondary)) !important;
        }
        
        [data-theme='dark'] div[style*="background: #f8fafc"],
        [data-theme='dark'] div[style*="background: var(--bg-light)"] {
            background: var(--bg-elevated) !important;
        }
        
        [data-theme='dark'] div[style*="background: #f0f9ff"] {
            background: var(--bg-elevated) !important;
        }
        
        [data-theme='dark'] div[style*="background: linear-gradient(135deg, #f0f9ff"] {
            background: linear-gradient(135deg, var(--bg-elevated), var(--bg-secondary)) !important;
        }
        
        .stats-number {
            font-size: 2.5em;
            font-weight: var(--font-weight-semibold);
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        
        .stats-label {
            color: var(--text-secondary);
            font-weight: var(--font-weight-medium);
            margin-bottom: 5px;
        }
        
        .stats-detail {
            color: var(--text-tertiary);
            font-size: 14px;
        }

        /* Pie Chart Styles */
        .pie-chart-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .pie-chart {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            position: relative;
        }

        .pie-chart-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            background: var(--bg-secondary);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            border: 2px solid var(--border-color);
        }

        .pie-chart-total {
            font-size: 1.5em;
            font-weight: var(--font-weight-semibold);
            color: var(--text-primary);
        }

        .pie-chart-label {
            font-size: 0.8em;
            color: var(--text-secondary);
        }

        .pie-chart-legend {
            display: flex;
            flex-direction: column;
            gap: 8px;
            width: 100%;
            padding: 0 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: var(--font-weight-medium);
            color: var(--text-secondary);
        }

        .legend-color-box {
            width: 16px;
            height: 16px;
            border-radius: 4px;
        }

        /* Calendar Styles */
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .calendar-nav {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        /* Modern Calendar Navigation Buttons */
        .calendar-nav-btn {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 50%;
            background: linear-gradient(145deg, var(--bg-elevated), var(--bg-secondary));
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1), inset 0 1px 2px rgba(255, 255, 255, 0.1);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
        }
        
        .calendar-nav-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15), inset 0 1px 3px rgba(255, 255, 255, 0.2);
            background: linear-gradient(145deg, var(--bg-hover), var(--bg-elevated));
        }
        
        .calendar-nav-btn:active {
            transform: scale(0.95);
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2), inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        /* Triangular Arrow Shapes */
        .calendar-nav-btn::before {
            content: '';
            width: 0;
            height: 0;
            position: absolute;
        }
        
        .calendar-nav-btn.prev::before {
            border-right: 8px solid var(--text-primary);
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
            margin-left: -2px;
        }
        
        .calendar-nav-btn.next::before {
            border-left: 8px solid var(--text-primary);
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
            margin-right: -2px;
        }
        
        /* Hover effect for triangle color */
        .calendar-nav-btn:hover::before {
            border-right-color: var(--primary-color);
            border-left-color: var(--primary-color);
        }
        
        /* Dark theme adjustments */
        [data-theme='dark'] .calendar-nav-btn {
            background: linear-gradient(145deg, #374151, #4b5563);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3), inset 0 1px 2px rgba(255, 255, 255, 0.05);
        }
        
        [data-theme='dark'] .calendar-nav-btn:hover {
            background: linear-gradient(145deg, #4b5563, #6b7280);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4), inset 0 1px 3px rgba(255, 255, 255, 0.1);
        }
        .calendar-grid {
            width: 100%;
            border-collapse: collapse;
        }
        .calendar-grid th {
            text-align: center;
            padding: 10px;
            font-weight: var(--font-weight-semibold);
            color: var(--text-secondary);
            font-size: 14px;
        }
        .calendar-grid td {
            border: 1px solid var(--border-color);
            height: 100px;
            vertical-align: top;
            padding: 8px;
            width: 14.28%;
        }
        .calendar-day {
            cursor: pointer;
            height: 100%;
            display: flex;
            flex-direction: column;
            border-radius: var(--border-radius);
            transition: background-color 0.2s;
        }
        .calendar-day:hover {
            background: var(--bg-hover);
        }
        .day-number {
            font-weight: var(--font-weight-semibold);
            font-size: 14px;
        }
        .calendar-day.other-month {
            opacity: 0.5;
        }
        .calendar-day.today .day-number {
            color: var(--primary-color);
            background-color: var(--bg-selected);
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        .dream-indicator {
            margin-top: 8px;
            background-color: var(--primary-color);
            color: var(--text-inverse);
            border-radius: 12px;
            padding: 2px 8px;
            font-size: 12px;
            font-weight: var(--font-weight-semibold);
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        
        /* Settings Tab Styling */
        .settings-section {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-lg);
            padding: 25px;
            margin-bottom: 20px;
            width: 100%;
            box-sizing: border-box;
        }
        
        .settings-section h3 {
            color: var(--text-primary);
            margin-bottom: 15px;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .settings-grid {
            padding: 0;
            width: 100%;
            box-sizing: border-box;
        }
        
        .settings-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--border-light);
        }
        
        .settings-row:last-child {
            border-bottom: none;
        }
        
        .settings-label {
            flex: 1;
            color: var(--text-primary);
            font-weight: var(--font-weight-medium);
        }
        
        .settings-description {
            color: var(--text-secondary);
            font-size: 14px;
            margin-top: 4px;
        }
        
        .settings-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        /* Mobile Tab Optimizations */
        @media (max-width: 768px) {
            .app-tab {
                min-width: 100px;
                padding: 14px 16px;
                font-size: 14px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
                padding: 0;
                gap: 15px;
            }
            
            .settings-grid {
                padding: 0;
            }
            
            .settings-row {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .settings-controls {
                width: 100%;
                justify-content: flex-start;
            }
        }
        
        /* Utility classes for common spacing */
        .text-center { text-align: center; }
        .font-weight-600 { font-weight: 600; }
        .border-radius-8 { border-radius: 8px; }
        .margin-bottom-20 { margin-bottom: 20px; }
        .padding-15 { padding: 15px; }
        .meta-item { display: inline; }
        .tag, .dream-sign {
            display: inline-block;
            padding: 3px 8px;
            margin: 2px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: lowercase;
        }
        .tag {
            background: var(--tag-bg);
            color: var(--tag-text);
            border: 1px solid var(--tag-border);
        }
        .dream-sign {
            background: var(--dream-sign-bg);
            color: var(--dream-sign-text);
            border: 1px solid var(--dream-sign-border);
        }
        .dream-sign::before {
            content: "⚡ ";
            font-size: 10px;
        }
        .entry-tags {
            margin-top: 8px;
            line-height: 1.4;
        }
        .entry-tags .tag-section {
            display: inline-block;
            margin-right: 12px;
        }
        .entry-tags .tag-label {
            font-size: 11px;
            color: #64748b;
            font-weight: 600;
            margin-right: 4px;
        }
        .tag-input-group {
            position: relative;
        }
        .tag-autocomplete-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--bg-elevated);
            border: 2px solid var(--border-color);
            border-top: none;
            border-radius: 0 0 var(--border-radius) var(--border-radius);
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            box-shadow: var(--shadow-md);
        }
        .autocomplete-item {
            padding: 8px 12px;
            cursor: pointer;
            border-bottom: 1px solid var(--border-light);
            font-size: 14px;
            transition: background-color 0.2s;
        }
        .autocomplete-item:hover {
            background-color: var(--bg-hover);
        }
        .autocomplete-item:last-child {
            border-bottom: none;
        }
        .timer-warning {
            background: var(--error-color);
            color: var(--text-inverse);
            padding: 15px 20px;
            text-align: center;
            font-weight: var(--font-weight-semibold);
            font-size: 16px;
            display: none;
            position: relative;
        }
        .timer-warning.active {
            display: block;
        }
        .timer-warning button {
            background: var(--text-inverse);
            color: var(--error-color);
            border: none;
            padding: 5px 15px;
            border-radius: 5px;
            margin-left: 15px;
            cursor: pointer;
            font-weight: var(--font-weight-semibold);
        }
        .timer-warning button:hover {
            background: var(--notification-error-bg);
        }
        .migration-notice {
            background: var(--notification-info-bg);
            color: var(--info-color);
            padding: 15px;
            border-radius: var(--border-radius);
            margin: 20px;
            font-weight: var(--font-weight-semibold);
            text-align: center;
            display: none;
        }
        .voice-recording-section {
            background: var(--voice-bg-primary);
            border: 2px solid var(--voice-border);
            border-radius: var(--border-radius-lg);
            padding: 20px;
            margin-bottom: 20px;
        }
        .voice-recording-section h3 {
            color: var(--voice-text);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .voice-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        .record-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 140px;
            justify-content: center;
        }
        .record-btn.ready {
            background: var(--success-color);
            color: var(--text-inverse);
        }
        .record-btn.ready:hover {
            background: var(--success-hover);
            transform: translateY(-2px);
        }
        .record-btn.recording {
            background: var(--error-color);
            color: var(--text-inverse);
            animation: pulse-record 1.5s ease-in-out infinite;
        }
        .record-btn.disabled {
            background: var(--text-muted);
            color: var(--text-tertiary);
            cursor: not-allowed;
        }
        @keyframes pulse-record {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .recording-timer {
            font-family: monospace;
            font-size: 18px;
            font-weight: var(--font-weight-semibold);
            color: var(--error-color);
            background: var(--notification-error-bg);
            padding: 8px 16px;
            border-radius: var(--border-radius);
            border: 2px solid var(--error-color);
        }
        .voice-status {
            font-size: 14px;
            padding: 8px 12px;
            border-radius: 6px;
            font-weight: 600;
        }
        .voice-status.info {
            background: var(--notification-info-bg);
            color: var(--info-color);
        }
        .voice-status.warning {
            background: var(--notification-warning-bg);
            color: var(--warning-color);
        }
        
        /* Force dark theme colors for voice status warning */
        [data-theme='dark'] .voice-status.warning {
            background: #78350f !important;
            color: #fde047 !important;
            border: 1px solid #a16207 !important;
        }
        
        /* Target voice status within voice recording section specifically */
        [data-theme='dark'] .voice-recording-section .voice-status.warning,
        [data-theme='dark'] .voice-tab-content .voice-status.warning {
            background: #78350f !important;
            color: #fde047 !important;
            border: 1px solid #a16207 !important;
        }
        
        /* Catch-all for any voice status warning in dark theme */
        [data-theme='dark'] *[class*="voice-status"][class*="warning"],
        [data-theme='dark'] div[class*="voice-status"][class*="warning"] {
            background: #78350f !important;
            color: #fde047 !important;
            border: 1px solid #a16207 !important;
        }
        [data-theme='dark'] body #voiceStatus.voice-status.warning,
        [data-theme='dark'] html body #voiceStatus.voice-status.warning {
            background: #78350f !important;
            color: #fde047 !important;
            border: 1px solid #a16207 !important;
        }
        .voice-status.error {
            background: var(--notification-error-bg);
            color: var(--error-color);
        }
        .voice-notes-section {
            margin-top: 30px;
            padding: 25px;
            background: var(--bg-light);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-lg);
        }
        .voice-notes-section h3 {
            color: var(--text-primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .voice-note {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        @media (max-width: 768px) {
            .voice-note-container {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
            .voice-note-controls {
                min-width: auto;
                justify-content: center;
            }
            .voice-progress-container {
                min-width: auto;
                margin: 0 5px;
            }
            
            /* Voice Tabs Mobile */
            .voice-tab {
                padding: 12px 16px;
                font-size: 14px;
            }
            
            .voice-tab-content {
                padding: 15px;
            }
            
            /* Stats Tabs Mobile */
            .stats-tab {
                padding: 12px 16px;
                font-size: 14px;
            }
            
            .stats-tab-content {
                padding: 15px;
            }

            #tipText {
                font-size: 0.9em;
            }

            #tipCounter {
                font-size: 0.6em;
            }
        }
        .voice-note:hover {
            border-color: #c7d2fe;
            box-shadow: 0 2px 8px rgba(79, 70, 229, 0.1);
        }
        .voice-note-info {
            flex: 1;
            min-width: 200px;
        }
        .voice-note-title {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 4px;
        }
        .voice-note-meta {
            color: #64748b;
            font-size: 14px;
        }
        .voice-note-controls {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
            min-width: 300px;
        }
        .voice-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .voice-btn.play {
            background: var(--info-color);
            color: var(--text-inverse);
        }
        .voice-btn.play:hover {
            background: #0284c7;
        }
        .voice-btn.pause {
            background: var(--warning-color);
            color: var(--text-inverse);
        }
        .voice-btn.pause:hover {
            background: #d97706;
        }
        .voice-btn.transcribe {
            background: #7c3aed;
            color: var(--text-inverse);
        }
        .voice-btn.transcribe:hover {
            background: #6d28d9;
        }
        .voice-btn.transcribe:disabled {
            background: var(--text-muted);
            cursor: not-allowed;
        }
        .voice-btn.download {
            background: var(--success-color);
            color: var(--text-inverse);
        }
        .voice-btn.download:hover {
            background: var(--success-hover);
        }
        .voice-btn.delete {
            background: var(--error-color);
            color: var(--text-inverse);
        }
        .voice-btn.delete:hover {
            background: var(--error-hover);
        }
        .voice-progress-container {
            flex: 1;
            min-width: 200px;
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 0 15px;
        }
        .voice-progress-bar {
            flex: 1;
            height: 6px;
            background: var(--border-color);
            border-radius: 3px;
            position: relative;
            cursor: pointer;
            transition: height 0.2s;
        }
        .voice-progress-bar:hover {
            height: 8px;
        }
        .voice-progress-fill {
            height: 100%;
            background: var(--primary-color);
            border-radius: 3px;
            width: 0%;
            transition: width 0.1s linear;
        }
        .voice-time-display {
            font-family: monospace;
            font-size: 12px;
            color: var(--text-secondary);
            min-width: 80px;
            text-align: center;
        }
        .voice-full-warning {
            background: var(--notification-error-bg);
            color: var(--error-color);
            padding: 12px;
            border-radius: var(--border-radius);
            border: 2px solid var(--error-color);
            margin-bottom: 15px;
            font-weight: var(--font-weight-semibold);
            text-align: center;
        }
        .no-voice-notes {
            text-align: center;
            color: var(--text-secondary);
            font-style: italic;
            padding: 30px;
            background: var(--bg-light);
            border: var(--border-dashed);
            border-radius: var(--border-radius);
        }
        
        /* RESPONSIVE DESIGN & MOBILE OPTIMIZATION */
        
        /* Mobile Responsive Design */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .header {
                padding: 20px;
            }
            .header h1 {
                font-size: 2em;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .control-row-break {
                display: none;
            }
            
            .search-filter-group {
                flex-direction: column;
                min-width: auto;
                gap: 10px;
            }
            
            .search-box, .filter-select {
                min-width: auto;
                flex: none;
            }
            
            .main-content {
                padding: 15px;
                overflow-x: hidden;
                max-width: 100%;
                box-sizing: border-box;
            }
            
            .tab-panel:not(#journalTab) {
                padding: 15px;
            }
            
            .entry-form {
                padding: 15px;
                margin-bottom: 20px;
            }
            
            /* Mobile Form Control Fixes */
            .form-control {
                padding: 10px 12px;
                font-size: 16px;
                width: 100%;
                box-sizing: border-box;
                max-width: 100%;
            }
            
            .form-group {
                margin-bottom: 15px;
            }
            
            .form-group label {
                font-size: 14px;
                margin-bottom: 6px;
            }
            
            .lucid-checkbox {
                margin-bottom: 15px;
            }
            
            textarea.form-control {
                min-height: 100px;
                resize: vertical;
            }
            
            .entry {
                padding: 15px;
            }
            
            .entry-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .entry-meta {
                width: 100%;
                justify-content: space-between;
                align-items: center;
            }
            
            .entry-actions {
                flex-shrink: 0;
            }
            
            .pagination {
                flex-direction: column;
                gap: 15px;
            }
            
            .page-numbers {
                order: -1;
            }
            
            .pagination-btn {
                min-width: 100px;
            }
            
            .security-controls {
                margin-left: 0;
                margin-top: 10px;
                justify-content: center;
            }
            
            .voice-note {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
            
            .voice-note-controls {
                min-width: auto;
                justify-content: center;
            }
            
            .voice-progress-container {
                min-width: auto;
                margin: 0 5px;
            }
        }
        
        /* Footer Styles */
        footer {
            background: var(--bg-light);
            border-top: 1px solid var(--border-color);
            padding: 20px;
            margin-top: 40px;
            text-align: center;
            color: var(--text-secondary);
            font-size: 14px;
        }
        
        footer div {
            max-width: 800px;
            margin: 0 auto;
        }
        
        footer p {
            margin-bottom: 10px;
        }
        
        footer p:last-child {
            margin: 0;
            font-size: 12px;
            opacity: 0.8;
        }


    </style>
        <script>
        (function() {
            try {
            var theme = localStorage.getItem('dreamJournalTheme') || 'dark';
            document.documentElement.setAttribute('data-theme', theme);
            } catch (e) {}
        })();
        </script>
</head>
<body>
    <!-- MAIN APPLICATION STRUCTURE -->
    
    <div class="container" style="visibility: hidden;">
        <div class="timer-warning" id="timerWarning">
            ⚠️ <strong>PIN RESET TIMER ACTIVE</strong> - Someone has initiated a PIN reset!
            <span id="timerWarningTime"></span>
            <button data-action="cancel-timer">Cancel Timer</button>
        </div>
        
        <div id="migrationNotice" class="migration-notice">
            📦 Migrating your dreams to improved storage...
        </div>
        
        <div class="header">
            <h1>🌙 Dream Journal</h1>
            <p>Capture your dreams and discover patterns for lucid dreaming</p>
        </div>
        
        <!-- Main App Tabs Navigation -->
        <div class="app-tabs">
            <button class="app-tab active" data-action="switch-app-tab" data-tab="journal">
                📝 Journal
            </button>
            <button class="app-tab" data-action="switch-app-tab" data-tab="goals">
                🎯 Goals
            </button>
            <button class="app-tab" data-action="switch-app-tab" data-tab="stats">
                📊 Stats
            </button>
            <button class="app-tab" data-action="switch-app-tab" data-tab="advice">
                💡 Advice
            </button>
            <button class="app-tab" data-action="switch-app-tab" data-tab="settings">
                ⚙️ Settings
            </button>
            <button class="app-tab" data-action="switch-app-tab" data-tab="lock" style="display: none;">
                🔒 Locked
            </button>
        </div>
        
        <!-- Tab Content Container -->
        <div class="tab-content-container">
            <!-- Journal Tab (All existing functionality) -->
            <div id="journalTab" class="tab-panel">
        <div class="main-content">
            <div class="entry-form" id="dreamFormFull">
                <h3 data-action="toggle-dream-form" style="cursor: pointer; user-select: none;">
                    🌙 Record Your Dream 
                    <span class="text-xs text-secondary font-normal">(Click to collapse)</span>
                </h3>
                <div class="form-group">
                    <label for="dreamDate">Dream Date & Time</label>
                    <input type="datetime-local" id="dreamDate" class="form-control">
                </div>
                <div class="lucid-checkbox">
                    <input type="checkbox" id="isLucid">
                    <label for="isLucid">This was a lucid dream ✨</label>
                </div>
                <div class="form-group">
                    <label for="dreamTitle">Dream Title (optional)</label>
                    <input type="text" id="dreamTitle" class="form-control" placeholder="Give your dream a memorable title...">
                </div>
                <div class="form-group">
                    <label for="dreamContent">Dream Description</label>
                    <textarea id="dreamContent" class="form-control" placeholder="Describe your dream in as much detail as you can remember..." required></textarea>
                </div>
                <div class="form-group">
                    <label for="dreamEmotions">Emotions Experienced (optional)</label>
                    <input type="text" id="dreamEmotions" class="form-control" placeholder="e.g., happy, anxious, excited, confused (separate with commas)">
                    <small class="small-helper">
                        Common emotions: happy, sad, anxious, excited, confused, peaceful, scared, angry, joyful, curious
                    </small>
                </div>
                <div class="form-group">
                    <label for="dreamTags">Tags & Themes (optional)</label>
                    <div class="tag-input-group">
                        <input type="text" id="dreamTags" class="form-control" placeholder="e.g., family, flying, school, animals (separate with commas)">
                    </div>
                    <small class="small-helper">
                        Tag your dream with themes, people, places, objects, or activities for easy searching
                    </small>
                </div>
                <div class="form-group">
                    <label for="dreamSigns">⚡ Dream Signs (Lucidity Triggers) (optional)</label>
                    <div class="tag-input-group">
                        <input type="text" id="dreamSigns" class="form-control" placeholder="e.g., flying, text-changing, deceased-alive (separate with commas)">
                    </div>
                    <small class="small-helper-warning">
                        Elements that could trigger lucidity - track these to improve dream awareness!
                    </small>
                </div>
                <button data-action="save-dream" class="btn btn-primary">Save Dream</button>
            </div>
            
            <!-- Collapsed Form State -->
            <div class="entry-form" id="dreamFormCollapsed" style="display: none;">
                <h3 data-action="toggle-dream-form" style="cursor: pointer; user-select: none;">
                    📝 Record Your Dream 
                    <span class="text-xs text-secondary font-normal">(Click to expand)</span>
                </h3>
            </div>
            
            <div class="voice-tabs-container">
                <div class="voice-tabs">
                    <button class="voice-tab active" data-action="switch-voice-tab" data-tab="record">
                        🎤 Record
                    </button>
                    <button class="voice-tab" data-action="switch-voice-tab" data-tab="stored">
                        🎵 Stored Notes
                    </button>
                </div>
                
                <div class="voice-tab-content">
                    <!-- Record Tab -->
                    <div id="voiceTabRecord" class="voice-tab-panel active">
                        <div class="voice-controls">
                            <button id="recordBtn" data-action="toggle-recording" class="record-btn ready">
                                <span id="recordIcon">🎤</span>
                                <span id="recordText">Start Recording</span>
                            </button>
                            <div id="recordingTimer" class="recording-timer" style="display: none;">0:00</div>
                            <div id="voiceStatus" class="voice-status info">Checking browser capabilities for voice features...</div>
                        </div>
                    </div>
                    
                    <!-- Stored Notes Tab -->
                    <div id="voiceTabStored" class="voice-tab-panel" style="display: none;">
                        <div id="voiceNotesContainer"></div>
                    </div>
                </div>
            </div>
            <div class="dreams-section-header">
                <h3>Your Dreams</h3>
                <div class="dreams-controls">
                    <button data-action="toggle-lock" id="lockBtn" class="btn btn-lock" title="Set up a PIN to secure your dreams, then lock the journal">🔒 Setup & Lock</button>
                    <button data-action="export-ai" class="btn btn-success" title="Export a prompt for analysis by an AI model">🤖 Export for AI Analysis</button>
                </div>
            </div>
            <div class="controls">
            <div class="search-filter-group">
                <input type="text" id="searchBox" class="search-box" placeholder="Search dreams by title, content, emotions, tags, or dream signs...">
                <select id="filterSelect" class="filter-select">
                    <option value="all">All Dreams</option>
                    <option value="lucid">Lucid Dreams</option>
                    <option value="non-lucid">Non-Lucid Dreams</option>
                </select>
                <select id="sortSelect" class="filter-select">
                    <option value="newest">Newest First</option>
                    <option value="oldest">Oldest First</option>
                    <option value="lucid-first">Lucid First</option>
                    <option value="longest">Longest First</option>
                </select>
                <select id="limitSelect" class="filter-select">
                    <option value="5">Show 5</option>
                    <option value="10">Show 10</option>
                    <option value="20">Show 20</option>
                    <option value="50">Show 50</option>
                    <option value="endless" selected>Endless</option>
                    <option value="all">Show All</option>
                </select>
            </div>
            <div class="date-filter-group" style="display: grid; grid-template-columns: auto 1fr auto 1fr; gap: 8px; align-items: center;">
                <label for="startDateFilter" class="form-label-inline text-primary" style="font-size: 13px;">From:</label>
                <input type="date" id="startDateFilter" class="filter-select" style="padding: 8px; font-size: 14px;">
                <label for="endDateFilter" class="form-label-inline text-primary" style="font-size: 13px;">To:</label>
                <input type="date" id="endDateFilter" class="filter-select" style="padding: 8px; font-size: 14px;">
            </div>
            <div class="control-row-break"></div>
        </div>
            <div class="entries-section">
                <div id="entriesContainer"></div>
                <div id="paginationContainer"></div>
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <footer class="app-footer">
        <div style="max-width: 800px; margin: 0 auto;">
            <p style="margin-bottom: 10px;">
                <strong>Disclaimer:</strong> This application is for entertainment and personal journaling purposes only. 
                It is not intended to provide medical, psychological, or therapeutic advice. 
                If you have concerns about your sleep, dreams, or mental health, please consult a qualified healthcare professional.
            </p>
            <p style="margin-bottom: 10px; font-size: 12px;">
                Licensed under <a href="https://www.gnu.org/licenses/agpl-3.0.html" target="_blank" style="color: var(--primary-color);">AGPL v3.0</a> | <a href="https://github.com/Webdreamjournal/DreamJournal" target="_blank" style="color: var(--primary-color);">Source Code</a>
            </p>
            <p class="app-footer p">
                Dream Journal v1.43.17 | Not a substitute for professional medical advice
            </p>
        </div>
    </footer>

    <!-- PIN Protection Overlay -->
    <div id="pinOverlay" class="pin-overlay" style="display: none;">
        <div class="pin-container">
            <h2 id="pinTitle">🔒 Enter PIN</h2>
            <p id="pinMessage">Your dreams are protected. Enter your PIN to access them.</p>
            <input type="password" id="pinInput" class="pin-input" placeholder="Enter PIN" maxlength="6">
            <div class="pin-buttons">
                <button data-action="verify-pin" class="btn btn-primary" id="pinMainBtn">Unlock</button>
                <button data-action="hide-pin-overlay" class="btn btn-secondary" id="cancelPinBtn">Cancel</button>
            </div>
            <div id="pinFeedback" class="notification-message error"></div>
            <div id="pinSuccess" class="notification-message success"></div>
            <div id="pinInfo" class="notification-message info"></div>
            <span data-action="show-pin-setup" class="pin-setup-link" id="pinSetupLink">Setup new PIN</span>
            <span data-action="show-remove-pin" class="pin-setup-link" id="removePinLink" style="display: none;">Remove PIN protection</span>
            <span data-action="show-forgot-pin" class="pin-setup-link" id="forgotPinLink" style="display: none;">Forgot PIN?</span>
        </div>
    </div>

    <input type="file" id="importFile" class="file-input" accept=".txt,.enc">
    <input type="file" id="importAllDataFile" class="file-input" accept=".json,.enc">
    <script src="dream-journal.js"></script>
</body>
</html>
